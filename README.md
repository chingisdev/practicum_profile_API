# Profile API

## Функциональные тесты сервиса Profile
Для того, чтобы применить функциональные тесты к API сервиса необходимо:

1. Установить пакетный менеджер poetry, если он ещё не установлен в системе;
2. Запустить виртуальное окуржение из корня проекта:
```bash
poetry shell
```
3. Убедиться в том, что все зависимости проекта включая необходимые для тестов (группа "tests"), установлены, запустив их установку:
```bash
poetry install
```
4. Запустить сервис Movies из соответствующего репозитория для тестов, заполнив .env и
запустив тестовый docker-compose:
```bash
make profile.tests 
```
или соответствующую команду:
```bash
docker compose --file docker-compose.profile-tests.yml up
```
5. Заполнить .ugc.env.development по образцу в .ugc.env.development.example;
6. Запустить контейнеры сервиса, используя тестовый docker-compose (в нём используются отдельные тестовые тома и опубликованы порты хранилищ):
```bash
docker compose --file docker-compose.tests.yml up
```
7. После того как контейнеры поднимутся, запустить функциональные тесты:
```bash
make test
```

#### NB. Применение тестов к Profile API, запущенному локально (в режиме отладки):
1. Остановите, контейнер profile api в тестовом docker compose'е;
2. Скорректируйте порты и хосты хранилищ и самого api в .ugc.env.development.example;
3. Запустите Profile API локально;
4. Запустите тесты той же командой.